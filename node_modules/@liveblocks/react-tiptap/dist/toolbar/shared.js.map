{"version":3,"file":"shared.js","sources":["../../src/toolbar/shared.tsx"],"sourcesContent":["import { useLayoutEffect } from \"@liveblocks/react/_private\";\nimport {\n  Children,\n  type ComponentProps,\n  createContext,\n  forwardRef,\n  useContext,\n  useId,\n} from \"react\";\n\n// This file is separate to avoid circular dependencies\n\ntype FloatingToolbarContext = {\n  close: () => void;\n  registerExternal: (id: string) => () => void;\n};\n\nexport const FloatingToolbarContext =\n  createContext<FloatingToolbarContext | null>(null);\n\nexport const FloatingToolbarExternal = forwardRef<\n  HTMLDivElement,\n  ComponentProps<\"div\">\n>(({ children, style, ...props }, forwardedRef) => {\n  const id = useId();\n  const externalId = `liveblocks-floating-toolbar-external-${id}`;\n  const floatingToolbarContext = useContext(FloatingToolbarContext);\n  const registerExternal = floatingToolbarContext?.registerExternal;\n\n  useLayoutEffect(() => {\n    if (!registerExternal) {\n      return;\n    }\n\n    return registerExternal(externalId);\n  }, [registerExternal, externalId]);\n\n  if (!floatingToolbarContext || Children.count(children) === 0) {\n    return <>{children}</>;\n  }\n\n  return (\n    <div\n      ref={forwardedRef}\n      style={{ display: \"contents\", ...style }}\n      data-liveblocks-floating-toolbar-external={id}\n      {...props}\n      id={externalId}\n    >\n      {children}\n    </div>\n  );\n});\n"],"names":[],"mappings":";;;;AAiBa,MAAA,sBAAA,GACX,cAA6C,IAAI,EAAA;AAEtC,MAAA,uBAAA,GAA0B,WAGrC,CAAC,EAAE,UAAU,KAAU,EAAA,GAAA,KAAA,IAAS,YAAiB,KAAA;AACjD,EAAA,MAAM,KAAK,KAAM,EAAA,CAAA;AACjB,EAAA,MAAM,aAAa,CAAwC,qCAAA,EAAA,EAAA,CAAA,CAAA,CAAA;AAC3D,EAAM,MAAA,sBAAA,GAAyB,WAAW,sBAAsB,CAAA,CAAA;AAChE,EAAA,MAAM,mBAAmB,sBAAwB,EAAA,gBAAA,CAAA;AAEjD,EAAA,eAAA,CAAgB,MAAM;AACpB,IAAA,IAAI,CAAC,gBAAkB,EAAA;AACrB,MAAA,OAAA;AAAA,KACF;AAEA,IAAA,OAAO,iBAAiB,UAAU,CAAA,CAAA;AAAA,GACjC,EAAA,CAAC,gBAAkB,EAAA,UAAU,CAAC,CAAA,CAAA;AAEjC,EAAA,IAAI,CAAC,sBAA0B,IAAA,QAAA,CAAS,KAAM,CAAA,QAAQ,MAAM,CAAG,EAAA;AAC7D,IAAO,uBAAA,GAAA,CAAA,QAAA,EAAA;AAAA,MAAG,QAAA;AAAA,KAAS,CAAA,CAAA;AAAA,GACrB;AAEA,EAAA,uBACG,GAAA,CAAA,KAAA,EAAA;AAAA,IACC,GAAK,EAAA,YAAA;AAAA,IACL,KAAO,EAAA,EAAE,OAAS,EAAA,UAAA,EAAY,GAAG,KAAM,EAAA;AAAA,IACvC,2CAA2C,EAAA,EAAA;AAAA,IAC1C,GAAG,KAAA;AAAA,IACJ,EAAI,EAAA,UAAA;AAAA,IAEH,QAAA;AAAA,GACH,CAAA,CAAA;AAEJ,CAAC;;;;"}