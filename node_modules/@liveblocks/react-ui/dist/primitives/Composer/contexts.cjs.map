{"version":3,"file":"contexts.cjs","sources":["../../../src/primitives/Composer/contexts.ts"],"sourcesContent":["import type { Placement } from \"@floating-ui/react-dom\";\nimport type { CommentMixedAttachment, EventSource } from \"@liveblocks/core\";\nimport { nn } from \"@liveblocks/core\";\nimport type { DropdownMenuProps } from \"@radix-ui/react-dropdown-menu\";\nimport type { Dispatch, Ref, SetStateAction } from \"react\";\nimport { createContext, useContext } from \"react\";\nimport type { Editor as SlateEditor, Element as SlateElement } from \"slate\";\n\nimport type { ComposerBodyMark, ComposerBodyMarks } from \"../../types\";\n\nexport type ComposerContext = {\n  /**\n   * Whether the composer is currently disabled.\n   */\n  isDisabled: boolean;\n\n  /**\n   * Whether the composer can currently be submitted.\n   */\n  canSubmit: boolean;\n\n  /**\n   * Whether the editor is currently focused.\n   */\n  isFocused: boolean;\n\n  /**\n   * Whether the editor is currently empty.\n   */\n  isEmpty: boolean;\n\n  /**\n   * Submit the composer programmatically.\n   */\n  submit: () => void;\n\n  /**\n   * Clear the composer programmatically.\n   */\n  clear: () => void;\n\n  /**\n   * Select the editor programmatically.\n   */\n  select: () => void;\n\n  /**\n   * Focus the editor programmatically.\n   */\n  focus: () => void;\n\n  /**\n   * Blur the editor programmatically.\n   */\n  blur: () => void;\n\n  /**\n   * Which text marks are currently active and which aren't.\n   */\n  marks: ComposerBodyMarks;\n\n  /**\n   * Toggle a specific text mark.\n   */\n  toggleMark: (mark: ComposerBodyMark) => void;\n\n  /**\n   * Start creating a mention at the current selection.\n   */\n  createMention: () => void;\n\n  /**\n   * Insert text at the current selection.\n   */\n  insertText: (text: string) => void;\n\n  /**\n   * Open a file picker programmatically to create attachments.\n   */\n  attachFiles: () => void;\n\n  /**\n   * The composer's current attachments.\n   */\n  attachments: CommentMixedAttachment[];\n\n  /**\n   * Remove an attachment by its ID.\n   */\n  removeAttachment: (attachmentId: string) => void;\n};\n\nexport type ComposerEditorContext = {\n  validate: (value: SlateElement[]) => void;\n  editor: SlateEditor;\n  setFocused: Dispatch<SetStateAction<boolean>>;\n  onEditorChange: EventSource<void>;\n  roomId: string;\n};\n\nexport type ComposerAttachmentsContext = {\n  hasMaxAttachments: boolean;\n  createAttachments: (files: File[]) => void;\n  isUploadingAttachments: boolean;\n  maxAttachments: number;\n  maxAttachmentSize: number;\n};\n\nexport type ComposerSuggestionsContext = {\n  dir?: DropdownMenuProps[\"dir\"];\n  id: string;\n  itemId: (value?: string) => string | undefined;\n  placement: Placement;\n  selectedValue?: string;\n  setSelectedValue: (value: string) => void;\n  onItemSelect: (value: string) => void;\n  ref: Ref<HTMLDivElement>;\n};\n\nexport type ComposerFloatingToolbarContext = {\n  dir?: DropdownMenuProps[\"dir\"];\n  id: string;\n  placement: Placement;\n  ref: Ref<HTMLDivElement>;\n};\n\nexport const ComposerContext = createContext<ComposerContext | null>(null);\nexport const ComposerEditorContext =\n  createContext<ComposerEditorContext | null>(null);\nexport const ComposerAttachmentsContext =\n  createContext<ComposerAttachmentsContext | null>(null);\nexport const ComposerSuggestionsContext =\n  createContext<ComposerSuggestionsContext | null>(null);\nexport const ComposerFloatingToolbarContext =\n  createContext<ComposerFloatingToolbarContext | null>(null);\n\nexport function useComposerEditorContext() {\n  const composerEditorContext = useContext(ComposerEditorContext);\n\n  return nn(\n    composerEditorContext,\n    \"Composer.Form is missing from the React tree.\"\n  );\n}\n\nexport function useComposerAttachmentsContextOrNull() {\n  return useContext(ComposerAttachmentsContext);\n}\n\nexport function useComposerAttachmentsContext() {\n  const composerAttachmentsContext = useComposerAttachmentsContextOrNull();\n\n  return nn(\n    composerAttachmentsContext,\n    \"Composer.Form is missing from the React tree.\"\n  );\n}\n\nexport function useComposerSuggestionsContext(\n  source = \"useComposerSuggestionsContext\"\n) {\n  const composerSuggestionsContext = useContext(ComposerSuggestionsContext);\n\n  return nn(\n    composerSuggestionsContext,\n    `${source} can’t be used outside of Composer.Editor.`\n  );\n}\n\nexport function useComposerFloatingToolbarContext(\n  source = \"useComposerFloatingToolbarContext\"\n) {\n  const composerFloatingToolbarContext = useContext(\n    ComposerFloatingToolbarContext\n  );\n\n  return nn(\n    composerFloatingToolbarContext,\n    `${source} can’t be used outside of Composer.Editor.`\n  );\n}\n\nexport function useComposer(): ComposerContext {\n  const composerContext = useContext(ComposerContext);\n\n  return nn(composerContext, \"Composer.Form is missing from the React tree.\");\n}\n"],"names":["createContext","useContext","nn"],"mappings":";;;;;AA8Ha,MAAA,eAAA,GAAkBA,oBAAsC,IAAI,EAAA;AAC5D,MAAA,qBAAA,GACXA,oBAA4C,IAAI,EAAA;AACrC,MAAA,0BAAA,GACXA,oBAAiD,IAAI,EAAA;AAC1C,MAAA,0BAAA,GACXA,oBAAiD,IAAI,EAAA;AAC1C,MAAA,8BAAA,GACXA,oBAAqD,IAAI,EAAA;AAEpD,SAAS,wBAA2B,GAAA;AACzC,EAAM,MAAA,qBAAA,GAAwBC,iBAAW,qBAAqB,CAAA,CAAA;AAE9D,EAAO,OAAAC,OAAA;AAAA,IACL,qBAAA;AAAA,IACA,+CAAA;AAAA,GACF,CAAA;AACF,CAAA;AAEO,SAAS,mCAAsC,GAAA;AACpD,EAAA,OAAOD,iBAAW,0BAA0B,CAAA,CAAA;AAC9C,CAAA;AAEO,SAAS,6BAAgC,GAAA;AAC9C,EAAA,MAAM,6BAA6B,mCAAoC,EAAA,CAAA;AAEvE,EAAO,OAAAC,OAAA;AAAA,IACL,0BAAA;AAAA,IACA,+CAAA;AAAA,GACF,CAAA;AACF,CAAA;AAEgB,SAAA,6BAAA,CACd,SAAS,+BACT,EAAA;AACA,EAAM,MAAA,0BAAA,GAA6BD,iBAAW,0BAA0B,CAAA,CAAA;AAExE,EAAO,OAAAC,OAAA;AAAA,IACL,0BAAA;AAAA,IACA,CAAG,EAAA,MAAA,CAAA,+CAAA,CAAA;AAAA,GACL,CAAA;AACF,CAAA;AAEgB,SAAA,iCAAA,CACd,SAAS,mCACT,EAAA;AACA,EAAA,MAAM,8BAAiC,GAAAD,gBAAA;AAAA,IACrC,8BAAA;AAAA,GACF,CAAA;AAEA,EAAO,OAAAC,OAAA;AAAA,IACL,8BAAA;AAAA,IACA,CAAG,EAAA,MAAA,CAAA,+CAAA,CAAA;AAAA,GACL,CAAA;AACF,CAAA;AAEO,SAAS,WAA+B,GAAA;AAC7C,EAAM,MAAA,eAAA,GAAkBD,iBAAW,eAAe,CAAA,CAAA;AAElD,EAAO,OAAAC,OAAA,CAAG,iBAAiB,+CAA+C,CAAA,CAAA;AAC5E;;;;;;;;;;;;;;"}